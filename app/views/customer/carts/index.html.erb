<div class="row">
	<!-- ページタイトル -->
	<div class="col-xs-3">
		<h3>ショッピングカート</h3>
	</div>

	<div class="col-xs-offset-6 col-xs-3">
		<!-- 全削除リンク -->
		<%= link_to "カートを空にする",destroy_carts_path,method: :delete,data: { confirm: 'カートを空にしてよろしいでしょうか?' },class: "btn btn-danger" %>
	</div>
</div>

<!-- カート一覧 -->
<table class="table table-hover table-inverse">
	<thead>
		<tr>
			<th>商品名</th>
			<th>単価（税込)</th>
			<th>数量</th>
			<th>小計</th>
			<th colspan="3"></th>
		</tr>
	</thead>
	<tbody>
		<!-- sumの初期化が必要 -->
		<% sum = 0 %>
		<!-- cartの一覧 -->
		<% @carts.each do |cart| %>
			<tr>
				<td><%= cart.product.name %></td>
				<td><%= cart.product.price %></td>
				<td>
					<%= form_for(cart,url: cart_path(cart)) do |f| %>
					<%= f.text_field :product_quantity, value: cart.product_quantity %>
					<%= f.submit '変更',class: "btn btn-primary" %>
					<% end %>
				</td>
				<td>
					<!-- 小計 -->
					<% sub_total = ((cart.product.price*cart.product_quantity)*Constant::TAX_RATE).round %>
					<%= sub_total %>

					<!-- 合計の計算 -->
					<% sum += sub_total %>
				</td>
				<td>
					<%= link_to "削除する",carts_path,method: :delete,data: { confirm: '削除してもよろしいでしょうか?' },class: "btn btn-danger" %>
				</td>
			</tr>
		<% end %>
	</tbody>
</table>



<div class="row">
	<div class="col-xs-3">
		<%= link_to "買い物を続ける", products_path,class: "btn btn-primary" %>
	</div>
	<div class="col-xs-offset-6 col-xs-3">
		<table>
			<tr>
				<th>
					<h4>合計金額</h4>
				</th>
				<td>
					<%= sum %>
				</td>
			</tr>
		</table>
	</div>
</div>

<%= link_to "情報入力に進む",new_order_path,class: "btn btn-success" %>

